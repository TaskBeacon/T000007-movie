# ============================================================================
# Scripted simulation config
# - Used by: python main.py sim --config config/config_scripted_sim.yaml
# - Scope: scripted simulation only (no qa section in this file)
# - Profile: short smoke run
# ============================================================================

# === Subject Form ===========================================================
subinfo_fields:
  - name: subject_id
    type: int
    constraints:
      min: 101
      max: 999
      digits: 3
  - name: subname
    type: string
  - name: age
    type: int
    constraints:
      min: 5
      max: 60
  - name: gender
    type: choice
    choices:
      - Male
      - Female

# === Subject Mapping ========================================================
subinfo_mapping:
  subject_id: Subject ID
  subname: Name
  age: Age
  gender: Gender
  Male: Male
  Female: Female
  registration_failed: Registration failed.
  registration_successful: Registration successful!
  invalid_input: "Invalid value for {field}."

# === Display / Window =======================================================
window:
  size:
    - 1920
    - 1080
  units: deg
  screen: 1
  bg_color: black
  fullscreen: true
  monitor_width_cm: 60
  monitor_distance_cm: 72

# === Task ===================================================================
task:
  task_name: eeg_movie_present
  save_path: ./outputs/sim
  language: Chinese
  voice_name: zh-CN-YunyangNeural
  voice_enabled: false
  total_blocks: 1
  total_trials: 1
  trial_per_block: 1
  conditions:
    - movie
  key_list:
    - space
  delta: 0.0
  seed_mode: same_across_sub

# === Stimuli ================================================================
stimuli:
  fixation:
    type: text
    text: "+"
    color: white

  movie:
    type: movie
    filename: assets/placeholder_movie.mp4
    size:
      - 22.1
      - 12.4
    units: deg

  instruction_text:
    type: textbox
    text: |
      [Movie Scripted Sim]
      Press [Space] to start.
    color: white
    pos:
      - 0
      - 0
    font: SimHei
    alignment: center
    letterHeight: 0.78
    units: deg
    size:
      - 20
      - 5

  good_bye:
    type: textbox
    text: |
      Scripted simulation completed.
      Press [Space] to exit.
    color: white
    font: SimHei
    alignment: center
    letterHeight: 0.78
    units: deg
    size:
      - 20
      - 5

# === Timing =================================================================
timing:
  cue_duration: 0.05
  anticipation_duration: 0.05
  movie_duration: 2.0

# === Triggers ===============================================================
triggers:
  map:
    exp_onset: 98
    exp_end: 99
    block_onset: 100
    block_end: 101
    movie_onset: 1
    movie_offset: 2

  driver:
    type: serial_url
    url: loop://
    baudrate: 115200
    timeout: 1
    prefix:
      - 1
      - 225
      - 1
      - 0

  policy:
    strict: false

  timing:
    post_delay_s: 0.001

# === Simulation Runtime =====================================================
sim:
  output_dir: outputs/sim
  seed: 0
  participant_id: sim001
  session_id: sub-sim001_task-eeg_movie_present_seed0
  log_path: outputs/sim/sub-sim001_task-eeg_movie_present_seed0_sim_events.jsonl
  policy: warn
  default_rt_s: 0.2
  clamp_rt: false
  responder:
    type: scripted
    kwargs:
      key: space
      rt_s: 0.25
